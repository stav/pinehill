---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE } from '../../consts';

// Mock data for now - will be replaced with database queries
const workOrders = [
	{
		id: 1,
		title: "Install new circuit breaker panel",
		description: "Need to upgrade the main electrical panel to support additional circuits for the workshop expansion.",
		status: "open",
		priority: "high",
		author: "John Smith",
		createdAt: new Date("2024-01-15"),
		comments: 5
	},
	{
		id: 2,
		title: "Fix flickering lights in kitchen",
		description: "Lights in the kitchen area are flickering intermittently. Suspected loose connection.",
		status: "in-progress",
		priority: "medium",
		author: "Sarah Johnson",
		createdAt: new Date("2024-01-10"),
		comments: 3
	},
	{
		id: 3,
		title: "Install outdoor lighting system",
		description: "Design and install LED lighting system for the backyard and garden area.",
		status: "open",
		priority: "low",
		author: "Mike Davis",
		createdAt: new Date("2024-01-08"),
		comments: 8
	}
];

const getStatusColor = (status: string) => {
	switch (status) {
		case 'open': return 'bg-green-100 text-green-800';
		case 'in-progress': return 'bg-blue-100 text-blue-800';
		case 'completed': return 'bg-gray-100 text-gray-800';
		case 'closed': return 'bg-red-100 text-red-800';
		default: return 'bg-gray-100 text-gray-800';
	}
};

const getPriorityColor = (priority: string) => {
	switch (priority) {
		case 'urgent': return 'bg-red-100 text-red-800';
		case 'high': return 'bg-orange-100 text-orange-800';
		case 'medium': return 'bg-yellow-100 text-yellow-800';
		case 'low': return 'bg-green-100 text-green-800';
		default: return 'bg-gray-100 text-gray-800';
	}
};
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={`Work Orders - ${SITE_TITLE}`} description="View and manage work orders for electrical projects" />
	</head>
	<body>
		<Header />
		<main class="min-h-screen bg-gray-50 py-8">
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
				<!-- Header -->
				<div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8">
					<div>
						<h1 class="text-3xl font-bold text-gray-900">Work Orders</h1>
						<p class="text-gray-600 mt-2">Track and manage electrical project work orders</p>
					</div>
					<a href="/work-orders/new" class="btn btn-primary mt-4 sm:mt-0">
						Create Work Order
					</a>
				</div>

				<!-- Filters -->
				<div class="card mb-6">
					<div class="flex flex-col sm:flex-row gap-4">
						<div class="flex-1">
							<input 
								type="text" 
								placeholder="Search work orders..." 
								class="input"
							>
						</div>
						<select class="input max-w-xs">
							<option value="">All Status</option>
							<option value="open">Open</option>
							<option value="in-progress">In Progress</option>
							<option value="completed">Completed</option>
							<option value="closed">Closed</option>
						</select>
						<select class="input max-w-xs">
							<option value="">All Priorities</option>
							<option value="urgent">Urgent</option>
							<option value="high">High</option>
							<option value="medium">Medium</option>
							<option value="low">Low</option>
						</select>
					</div>
				</div>

				<!-- Work Orders List -->
				<div class="space-y-4">
					{workOrders.map((order) => (
						<div class="card hover:shadow-md transition-shadow">
							<div class="flex flex-col sm:flex-row sm:items-center justify-between">
								<div class="flex-1">
									<div class="flex items-start justify-between">
										<div class="flex-1">
											<h3 class="text-lg font-semibold text-gray-900 mb-2">
												<a href={`/work-orders/${order.id}`} class="hover:text-primary-600">
													{order.title}
												</a>
											</h3>
											<p class="text-gray-600 mb-3 line-clamp-2">
												{order.description}
											</p>
											<div class="flex flex-wrap gap-2 mb-3">
												<span class={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(order.status)}`}>
													{order.status.replace('-', ' ')}
												</span>
												<span class={`px-2 py-1 rounded-full text-xs font-medium ${getPriorityColor(order.priority)}`}>
													{order.priority}
												</span>
											</div>
										</div>
									</div>
									<div class="flex items-center text-sm text-gray-500">
										<span>By {order.author}</span>
										<span class="mx-2">•</span>
										<span>{order.createdAt.toLocaleDateString()}</span>
										<span class="mx-2">•</span>
										<span>{order.comments} comments</span>
									</div>
								</div>
							</div>
						</div>
					))}
				</div>

				<!-- Empty State -->
				{workOrders.length === 0 && (
					<div class="card text-center py-12">
						<svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
						</svg>
						<h3 class="text-lg font-medium text-gray-900 mb-2">No work orders found</h3>
						<p class="text-gray-600 mb-4">Get started by creating your first work order.</p>
						<a href="/work-orders/new" class="btn btn-primary">
							Create Work Order
						</a>
					</div>
				)}
			</div>
		</main>
		<Footer />
	</body>
</html> 
